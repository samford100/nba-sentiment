{"version":3,"sources":["../../../src/command/game/schedule.js"],"names":["MAX_WIDTH","TEAMNAME_WIDTH","STATUS_WIDTH","padHomeTeamName","name","padVisitorTeamName","padGameStatus","status","createGameChoice","homeTeam","visitorTeam","periodTime","winner","periodStatus","period_status","gameClock","game_clock","getScore","homeTeamName","getWinnerName","getName","color","visitorTeamName","match","get","homeTeamScore","visitorTeamScore","score","getTeamInfo","team","seasonId","teamInfoCommon","TeamID","id","Season","teamInfo","linescores","isHomeTeam","chooseGameFromSchedule","gamesData","spinner","start","header","questions","message","type","pageSize","choices","Separator","last","length","gameData","index","home","visitor","period_time","process","env","season","push","value","concurrency","stop","answer","prompt"],"mappings":";;;;;;;;;;;;;;;AAAA;;;;AACA;;;;AACA;;AACA;;AACA;;;;AACA;;;;AAEA;;;;AAEA;;;;AACA;;;;AAEA,MAAMA,YAAY,EAAlB;AACA,MAAMC,iBAAiB,EAAvB;AACA,MAAMC,eAAe,EAArB;;AAEA,MAAMC,kBAAkBC,QAAQ,eAAK,sBAAMA,IAAN,EAAYH,cAAZ,CAAL,CAAhC;AACA,MAAMI,qBAAqBD,QAAQ,eAAK,qBAAKA,IAAL,EAAWH,cAAX,CAAL,CAAnC;AACA,MAAMK,gBAAgBC,UAAU,uBAAOA,MAAP,EAAeL,YAAf,CAAhC;;AAEA,MAAMM,mBAAmB,CAACC,QAAD,EAAWC,WAAX,EAAwBC,UAAxB,KAAuC;AAC9D,MAAIC,SAAS,EAAb;AAD8D,QAEvCC,YAFuC,GAECF,UAFD,CAEtDG,aAFsD;AAAA,QAEbC,SAFa,GAECJ,UAFD,CAEzBK,UAFyB;;;AAI9D,MAAI,CAACP,SAASQ,QAAT,EAAD,GAAuB,CAACP,YAAYO,QAAZ,EAA5B,EAAoD;AAClDL,aAAS,MAAT;AACD,GAFD,MAEO,IAAI,CAACH,SAASQ,QAAT,EAAD,KAAyB,CAACP,YAAYO,QAAZ,EAA9B,EAAsD;AAC3DL,aAAS,IAAT;AACD,GAFM,MAEA;AACLA,aAAS,SAAT;AACD;;AAED,QAAMM,eAAef,gBACnBS,WAAW,MAAX,GACIH,SAASU,aAAT,CAAuB,MAAvB,CADJ,GAEIV,SAASW,OAAT,CAAiB,EAAEC,OAAO,IAAT,EAAjB,CAHe,CAArB;AAKA,QAAMC,kBAAkBjB,mBACtBO,WAAW,SAAX,GACIF,YAAYS,aAAZ,CAA0B,OAA1B,CADJ,GAEIT,YAAYU,OAAZ,CAAoB,EAAEC,OAAO,IAAT,EAApB,CAHkB,CAAxB;AAKA,QAAME,QAAS,GAAEL,YAAa,GAAE,uBAAO,oBAAMM,GAAN,CAAU,YAAV,CAAP,EAAgC,CAAhC,CAAmC,GACjEF,eACD,EAFD;AAGA,QAAMG,gBACJb,WAAW,MAAX,GACI,sBAAM,eAAK,oBAAUH,SAASQ,QAAT,EAAV,CAAL,CAAN,EAA4C,CAA5C,CADJ,GAEI,sBAAM,eAAKR,SAASQ,QAAT,EAAL,CAAN,EAAiC,CAAjC,CAHN;AAIA,QAAMS,mBACJd,WAAW,SAAX,GACI,qBAAK,eAAK,oBAAUF,YAAYO,QAAZ,EAAV,CAAL,CAAL,EAA8C,CAA9C,CADJ,GAEI,qBAAK,eAAKP,YAAYO,QAAZ,EAAL,CAAL,EAAmC,CAAnC,CAHN;AAIA,QAAMU,QAAS,GAAEF,aAAc,MAAKC,gBAAiB,EAArD;;AAEA,SAAQ,KAAIH,KAAM,IAAGI,KAAM,IAAGrB,cAC3B,GAAE,eAAKO,YAAL,CAAmB,IAAGE,SAAU,EADP,CAE5B,GAFF;AAGD,CAtCD;;AAwCA,MAAMa;AAAA,6CAAc,WAAOC,IAAP,EAAaC,QAAb,EAA0B;AAAA,gBACP,MAAM,cAAIC,cAAJ,CAAmB;AAC5DC,cAAQH,KAAKI,EAD+C;AAE5DC,cAAQJ;AAFoD,KAAnB,CADC;;AAAA,UACpBK,QADoB,SACpCJ,cADoC;;;AAM5C,WAAO,8CACFI,SAAS,CAAT,CADE;AAELR,aAAOE,KAAKF,KAFP;AAGLS,kBAAYP,KAAKO,UAHZ;AAILC,kBAAY;AAJP,OAAP;AAMD,GAZK;;AAAA;AAAA;AAAA;AAAA,IAAN;;AAcA,MAAMC;AAAA,8CAAyB,WAAMC,SAAN,EAAmB;AAChD,UAAMC,UAAU,mBAAI,uBAAJ,EAA6BC,KAA7B,EAAhB;AACA,UAAMC,SAAU,KAAIvC,gBAAgB,MAAhB,CAAwB,GAAE,uBAC5C,oBAAMqB,GAAN,CAAU,YAAV,CAD4C,EAE5C,CAF4C,CAG5C,GAAEnB,mBAAmB,MAAnB,CAA2B,IAAG,uBAAO,OAAP,EAAgB,EAAhB,CAAoB,IAAGC,cACvD,QADuD,CAEvD,GALF;;AAOA,UAAMqC,YAAY,CAChB;AACEvC,YAAM,MADR;AAEEwC,eAAS,kCAFX;AAGEC,YAAM,MAHR;AAIEC,gBAAU,EAJZ;AAKEC,eAAS,CACP,IAAI,mBAASC,SAAb,CAAwB,GAAE,oBAAM,EAAN,EAAUhD,SAAV,EAAqB,GAArB,CAA0B,EAApD,CADO,EAEP,IAAI,mBAASgD,SAAb,CAAuBN,MAAvB,CAFO,EAGP,IAAI,mBAASM,SAAb,CAAwB,GAAE,oBAAM,EAAN,EAAUhD,SAAV,EAAqB,GAArB,CAA0B,EAApD,CAHO;AALX,KADgB,CAAlB;;AAcA,UAAMiD,OAAOV,UAAUW,MAAV,GAAmB,CAAhC;;AAEA,UAAM,oBACJX,SADI;AAAA,kDAEJ,WAAOY,QAAP,EAAiBC,KAAjB,EAA2B;AAAA,cACjBC,IADiB,GACcF,QADd,CACjBE,IADiB;AAAA,cACXC,OADW,GACcH,QADd,CACXG,OADW;AAAA,cACFC,WADE,GACcJ,QADd,CACFI,WADE;;;AAGzB,cAAM9C,WAAW,MAAMmB,YAAYyB,IAAZ,EAAkBG,QAAQC,GAAR,CAAYC,MAA9B,CAAvB;AACA,cAAMhD,cAAc,MAAMkB,YAAY0B,OAAZ,EAAqBE,QAAQC,GAAR,CAAYC,MAAjC,CAA1B;;AAEAf,kBAAU,CAAV,EAAaI,OAAb,CAAqBY,IAArB,CAA0B;AACxBvD,gBAAMI,iBAAiBC,QAAjB,EAA2BC,WAA3B,EAAwC6C,WAAxC,CADkB;AAExBK,iBAAO,EAAET,QAAF,EAAY1C,QAAZ,EAAsBC,WAAtB;AAFiB,SAA1B;;AAKA,YAAI0C,UAAUH,IAAd,EAAoB;AAClBN,oBAAU,CAAV,EAAaI,OAAb,CAAqBY,IAArB,CACE,IAAI,mBAASX,SAAb,CAAwB,GAAE,oBAAM,EAAN,EAAUhD,SAAV,EAAqB,GAArB,CAA0B,EAApD,CADF;AAGD,SAJD,MAIO;AACL2C,oBAAU,CAAV,EAAaI,OAAb,CAAqBY,IAArB,CACE,IAAI,mBAASX,SAAb,CAAwB,GAAE,oBAAM,EAAN,EAAUhD,SAAV,EAAqB,GAArB,CAA0B,EAApD,CADF;AAGD;AACF,OAtBG;;AAAA;AAAA;AAAA;AAAA,UAuBJ,EAAE6D,aAAa,CAAf,EAvBI,CAAN;;AA0BArB,YAAQsB,IAAR;;AAEA,UAAMC,SAAS,MAAM,mBAASC,MAAT,CAAgBrB,SAAhB,CAArB;;AAEA,WAAOoB,MAAP;AACD,GAxDK;;AAAA;AAAA;AAAA;AAAA,IAAN;;kBA0DezB,sB;QACNV,W,GAAAA,W","file":"schedule.js","sourcesContent":["import inquirer from 'inquirer';\nimport emoji from 'node-emoji';\nimport { limit } from 'stringz';\nimport { center, left, right } from 'wide-align';\nimport pMap from 'p-map';\nimport ora from 'ora';\n\nimport Team from '../Team';\n\nimport NBA from '../../utils/nba';\nimport { bold, neonGreen } from '../../utils/log';\n\nconst MAX_WIDTH = 81;\nconst TEAMNAME_WIDTH = 20;\nconst STATUS_WIDTH = 18;\n\nconst padHomeTeamName = name => bold(right(name, TEAMNAME_WIDTH));\nconst padVisitorTeamName = name => bold(left(name, TEAMNAME_WIDTH));\nconst padGameStatus = status => center(status, STATUS_WIDTH);\n\nconst createGameChoice = (homeTeam, visitorTeam, periodTime) => {\n  let winner = '';\n  const { period_status: periodStatus, game_clock: gameClock } = periodTime;\n\n  if (+homeTeam.getScore() > +visitorTeam.getScore()) {\n    winner = 'home';\n  } else if (+homeTeam.getScore() === +visitorTeam.getScore()) {\n    winner = null;\n  } else {\n    winner = 'visitor';\n  }\n\n  const homeTeamName = padHomeTeamName(\n    winner === 'home'\n      ? homeTeam.getWinnerName('left')\n      : homeTeam.getName({ color: true })\n  );\n  const visitorTeamName = padVisitorTeamName(\n    winner === 'visitor'\n      ? visitorTeam.getWinnerName('right')\n      : visitorTeam.getName({ color: true })\n  );\n  const match = `${homeTeamName}${center(emoji.get('basketball'), 8)}${\n    visitorTeamName\n  }`;\n  const homeTeamScore =\n    winner === 'home'\n      ? right(bold(neonGreen(homeTeam.getScore())), 4)\n      : right(bold(homeTeam.getScore()), 4);\n  const visitorTeamScore =\n    winner === 'visitor'\n      ? left(bold(neonGreen(visitorTeam.getScore())), 4)\n      : left(bold(visitorTeam.getScore()), 4);\n  const score = `${homeTeamScore} : ${visitorTeamScore}`;\n\n  return `│⌘${match}│${score}│${padGameStatus(\n    `${bold(periodStatus)} ${gameClock}`\n  )}│`;\n};\n\nconst getTeamInfo = async (team, seasonId) => {\n  const { teamInfoCommon: teamInfo } = await NBA.teamInfoCommon({\n    TeamID: team.id,\n    Season: seasonId,\n  });\n\n  return new Team({\n    ...teamInfo[0],\n    score: team.score,\n    linescores: team.linescores,\n    isHomeTeam: true,\n  });\n};\n\nconst chooseGameFromSchedule = async gamesData => {\n  const spinner = ora('Loading Game Schedule').start();\n  const header = `│ ${padHomeTeamName('Home')}${center(\n    emoji.get('basketball'),\n    8\n  )}${padVisitorTeamName('Away')}│${center('Score', 11)}│${padGameStatus(\n    'Status'\n  )}│`;\n\n  const questions = [\n    {\n      name: 'game',\n      message: 'Which game do you want to watch?',\n      type: 'list',\n      pageSize: 30,\n      choices: [\n        new inquirer.Separator(`${limit('', MAX_WIDTH, '─')}`),\n        new inquirer.Separator(header),\n        new inquirer.Separator(`${limit('', MAX_WIDTH, '─')}`),\n      ],\n    },\n  ];\n\n  const last = gamesData.length - 1;\n\n  await pMap(\n    gamesData,\n    async (gameData, index) => {\n      const { home, visitor, period_time } = gameData;\n\n      const homeTeam = await getTeamInfo(home, process.env.season);\n      const visitorTeam = await getTeamInfo(visitor, process.env.season);\n\n      questions[0].choices.push({\n        name: createGameChoice(homeTeam, visitorTeam, period_time),\n        value: { gameData, homeTeam, visitorTeam },\n      });\n\n      if (index !== last) {\n        questions[0].choices.push(\n          new inquirer.Separator(`${limit('', MAX_WIDTH, '-')}`)\n        );\n      } else {\n        questions[0].choices.push(\n          new inquirer.Separator(`${limit('', MAX_WIDTH, '─')}`)\n        );\n      }\n    },\n    { concurrency: 1 }\n  );\n\n  spinner.stop();\n\n  const answer = await inquirer.prompt(questions);\n\n  return answer;\n};\n\nexport default chooseGameFromSchedule;\nexport { getTeamInfo };\n"]}